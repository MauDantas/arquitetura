if (self.CavalryLogger) { CavalryLogger.start_js(["1VbvH"]); }

__d("XRefererFrameController",["XController"],(function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/common\/referer_frame.php",{v:{type:"Int"}});}),null);
__d('ControlledReferer',['URI','UserAgent','XRefererFrameController','isMessengerDotComURI','lowerFacebookDomain'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={useFacebookReferer:function(i,j,k){var l=false;function m(){if(l)return;var o=i.contentWindow.location.pathname;if(o!=='/intern/common/referer_frame.php'&&o!=='/common/referer_frame.php')return;l=true;i.contentWindow.document.body.style.margin=0;j();}var n;if(c('isMessengerDotComURI')(c('URI').getRequestURI())){n=c('XRefererFrameController').getURIBuilder().getURI().toString();}else if(!c('lowerFacebookDomain').isValidDocumentDomain()){n='/intern/common/referer_frame.php';}else if(c('UserAgent').isBrowser('Opera')){n=c('XRefererFrameController').getURIBuilder().getURI().toString();}else n=c('XRefererFrameController').getURIBuilder().getURI().qualify().setProtocol('https').setSubdomain('staticxx').toString();if(k)n+='?fb_source='+k;i.onload=m;i.src=n;},useFacebookRefererHtml:function(i,j,k){h.useFacebookReferer(i,function(){i.contentWindow.document.body.innerHTML=j;},k);}};f.exports=h;}),null);
__d('TrackingPixel',['Arbiter','ControlledReferer','NonBlockingIFrame','WebSpeedExperiments'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={_iframe:undefined,loadWithNoReferrer:function(i){if(!h._iframe)if(c('WebSpeedExperiments').non_blocking_logger){h._iframe=true;c('NonBlockingIFrame').loadIFrame().then(function(k){h._iframe=k;c('ControlledReferer').useFacebookReferer(k,function(){c('Arbiter').inform('TrackingPixel/iframeIsLoaded',null,c('Arbiter').BEHAVIOR_PERSISTENT);},null);}).done();}else{var j=document.createElement('iframe');j.frameborder=0;j.width=j.height=1;j.style.position='absolute';j.style.top='-10px';c('ControlledReferer').useFacebookReferer(j,function(){c('Arbiter').inform('TrackingPixel/iframeIsLoaded',null,c('Arbiter').BEHAVIOR_PERSISTENT);},null);document.body.appendChild(j);h._iframe=j;}c('Arbiter').subscribe('TrackingPixel/iframeIsLoaded',function(){var k=h._iframe.contentWindow,l=new k.Image();l.src=i;});}};f.exports=h;}),null);
__d('ExternalTrackingTag',['AsyncSignal','TrackingPixel','Event'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={listenForElementClick:function(i,j,k,l,m){c('Event').listen(i,'click',function(){h.sendRequest(j,k,l,m);});},sendRequest:function(i,j,k,l){if(!i)return;new (c('AsyncSignal'))('/ads/external_tracking_tag/',{href:i,tracking_tag_id:j,adgroup_id:k,ad_id:l}).send();c('TrackingPixel').loadWithNoReferrer(i);}};f.exports=h;}),null);
__d('FeedAdsClickLogger',['Arbiter','AsyncRequest','Banzai','BanzaiODS','collectDataAttributes','DataAttributeUtils','DOM','ge','LitestandMessages','LitestandStream','Parent','TrackingNodes','ExternalTrackingTag','URI','isFacebookURI'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h='ssinfeed',i={},j=false,k=[],l;function m(){'use strict';}m.prototype.init=function(o){'use strict';l=o.use_feed_renderer;c('Arbiter').subscribe("ClickRefAction/new",this.onNewUserAction.bind(this));if(o.append_tracking_data_to_links){this.appendTrackingDataToLinks();c('Arbiter').subscribe(c('LitestandMessages').STORIES_INSERTED,this.appendTrackingDataToLinks.bind(this));c('Arbiter').subscribe('FeedAdsClickLogger/refreshTrackingData',this.appendTrackingDataToLinks.bind(this),c('Arbiter').SUBSCRIBE_NEW);}};m.prototype.getStories=function(){'use strict';var o=c('LitestandStream').getStreamRoot();if(o){return c('DOM').scry(o,c('LitestandStream').getStoriesSelector());}else{var p=c('ge')('home_stream');if(p)return c('DOM').scry(p,'.uiStreamStory');}return [];};m.prototype.appendTrackingDataToLinks=function(){'use strict';var o=this.getStories();for(var p=0;p<o.length;p++){var q=o[p];if(q in k)continue;var r=c('DataAttributeUtils').getDataFt(q);if(!r||r.indexOf('ei')===-1&&r.indexOf('mei')===-1)continue;var s=c('DOM').scry(q,'a');for(var t=0;t<s.length;t++){var u=s[t];if(u.getAttribute('ajaxify')!=null)continue;if(u.getAttribute('rel')!=null)continue;var v=u.getAttribute('href');if(!v||v.charAt(0)==='#')continue;var w=new (c('URI'))(u);if(c('isFacebookURI')(w)===false)continue;if(w.isLinkshimURI()===true)continue;if(l&&w.getPath()==='/about/ads')continue;u.setAttribute('href',n(u).toString());u.setAttribute('onmousedown',"this.href = this.href.replace('__md__=0', '__md__=1');");}k.push(q);}};m.prototype.getHref=function(o){'use strict';return (o.getAttribute&&(o.getAttribute('ajaxify')||o.getAttribute('data-endpoint'))||o.action||o.href);};m.prototype.sendLogRequest=function(o,p){'use strict';var q=o.ei||o.ai;if(!q&&o.mei)q=o.mf_story_key;if(o!==null&&typeof q==="string"){var r=false;if(o.tn){var s=c('TrackingNodes').parseTrackingNodeString(o.tn);for(var t=0;t<s.length;t++){var u=s[t][0];switch(u){case c('TrackingNodes').types.LIKE_LINK:case c('TrackingNodes').types.UNLIKE_LINK:case c('TrackingNodes').types.COMMENT:case c('TrackingNodes').types.COMMENT_LINK:case c('TrackingNodes').types.ADD_COMMENT_BOX:case c('TrackingNodes').types.MULTI_ATTACHMENT_VIDEO:return;case c('TrackingNodes').types.XBUTTON:case c('TrackingNodes').types.HIDE_LINK:case c('TrackingNodes').types.REPORT_SPAM_LINK:case c('TrackingNodes').types.HIDE_ALL_LINK:case c('TrackingNodes').types.DROPDOWN_BUTTON:case c('TrackingNodes').types.UNHIDE_LINK:return;case c('TrackingNodes').types.RELATED_SHARE_ARTICLE:case c('TrackingNodes').types.RELATED_SHARE_VIDEO:return;case c('TrackingNodes').types.ATTACHMENT:case c('TrackingNodes').types.USER_MESSAGE:r=true;break;}}}var v=Date.now(),w=500;o.duplicate_click=!!i[q]&&v-i[q]<w;i[q]=v;if(c('Banzai').isEnabled('ssinfeed')){c('Banzai').post(h,o,{delay:0,retry:c('Banzai').isEnabled('ssinfeed_retry')});}else{var x=new (c('AsyncRequest'))('/ajax/ssinfeed/end/').setData(o).setAllowCrossPageTransition(true).setMethod('POST');x.send();}var y=o.href;if(new (c('URI'))(y).isLinkshimURI()&&new (c('URI'))(y).getQueryData())y=new (c('URI'))(y).getQueryData().u;if(r&&!o.duplicate_click&&p!==null&&p.url&&y&&c('isFacebookURI')(new (c('URI'))(y))===false){c('ExternalTrackingTag').sendRequest(p.url,p.tag_id,p.adgroup_id);c('BanzaiODS').bumpEntityKey('external_tracking_tags','request_sent');}}};m.prototype.onNewUserAction=function(o,p){'use strict';if(!p.node)return;var q=this.getHref(p.node),r=c('Parent').byTag(p.node,'input')||c('Parent').byTag(p.node,'button');if(!q&&r&&r.type=="submit"&&r.getAttribute&&c('DataAttributeUtils').getDataFt(r))q="#";var s,t;if(q&&p.event&&(p.event.type==='click'||p.event.type==='contextmenu')){s=c('collectDataAttributes')(p.node,['ft']);s.ft.href=q;s.ft.mouse_type=p.event.type;t=c('collectDataAttributes')(p.node,['external-tracking-tags']);this.sendLogRequest(s.ft,t['external-tracking-tags']);}};function n(o){var p=new (c('URI'))(o.href),q=c('collectDataAttributes')(o,['ft']).ft,r=p.getQueryData();r.ft=q;r.__md__=0;p.setQueryData(r);return p;}f.exports={init:function(o){if(j===false){new m().init(o);j=true;}},buildURL:n};}),null);